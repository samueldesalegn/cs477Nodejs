This question took some considerable time to solve.